<?php
 session_start();
if (isset($_SESSION['username']) && !empty($_SESSION['username'])) {

  } else {
    // They are not logged in, redirect them
  header('Location: login.php');
  }
?>

<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.4/ace.js" type="text/javascript" charset="utf-8"></script>
<style>
html,body { margin: 0; padding: 0; height: 100%; width: 100%; overflow: hidden;}
.editor{
	height: 82%;
	width: 100%;
	width: 50%;
	display: inline-block;

}

.iframe{
	height: 82%;
	width: 50%;
	display: inline-block;
	width: 100%;
}

.container{
	height: 100%;
	width: auto;
	white-space: nowrap;
	overflow: hidden;
	background: white;
}
</style>
</head>
<script>
function update()
{
	var idoc = document.getElementById('iframe').contentWindow.document;

	idoc.open();
	idoc.write(editor.getValue());
	idoc.close();
}

	function php()
	{
		window.editor = ace.edit("editor");
  editor.setTheme("ace/theme/monokai");
  editor.getSession().setMode("ace/mode/php");
  editor.setValue(`<?php?>`,1); //1 = moves cursor to end

  editor.getSession().on('change', function() {

  });

  editor.focus();
  
  
  editor.setOptions({
    fontSize: "12pt",
    showLineNumbers: true,
    showGutter: true,
    vScrollBarAlwaysVisible:true,
    enableBasicAutocompletion: true, enableLiveAutocompletion: true
  });

  editor.setShowPrintMargin(true);
  editor.setBehavioursEnabled(true);
	}

	function ready()
	{
		php();
		update();
	}
</script>
<body onload='ready()'>

	<nav>
        <div class="Logo">
            <h1>Dreamers<c style="color: orange">Forums</c></h1>
        </div>
        <ul class="nav-links">
            <li><a href="home.php"><i class="fa fa-home mr-1"></i>Home</a></li>
            <li><a href="profile.php"><i class="fa fa-home mr-1"></i>Profile</a></li>
            <li><a href="logout.php"><i class="fa fa-sign-in-alt"></i>Sign Out</a></li>
            <li><a href="IDE.php"><i class="fa fa-sign-in-alt"></i>Coding Online</a></li>
        </ul>
    </nav>
    <div class="under-navbar-rainbow"></div>

<div class="container" id='container'>
<div class="editor" id='editor'>

</div>
<iframe class="editor" id='iframe' frameborder="0">
	
</iframe>
    <div class="under-ide-rainbow">
    	<button class="run-code-button" onclick="update();">Run Code</button>
    	<button class="html-code-button" onclick="html();">HTML</button>
    	<button class="php-code-button" onclick="php();">PHP</button>
    	<button class="reset-code-button" onclick="ready();">Reset</button>
    	<button class="save-code-button" onclick="">Disabled!</button>
    	<h3 class="welcome-ide-text">Welcome to the Dreamers Forums Online IDE: <?php echo $_SESSION['username']; ?></h1>
    </div>
</div>

<script>
function update()
{
	var idoc = document.getElementById('iframe').contentWindow.document;

	idoc.open();
	idoc.write(editor.getValue());
	idoc.close();
}

	function html()
	{
		window.editor = ace.edit("editor");
  editor.setTheme("ace/theme/monokai");
  editor.getSession().setMode("ace/mode/html");
  editor.setValue(`<!DOCTYPE html>
<html>
	<head>
		<title>Page Title</title>
	</head>
	<body>
		
	</body>
</html>`,1); //1 = moves cursor to end

  editor.getSession().on('change', function() {

  });

  editor.focus();
  
  
  editor.setOptions({
    fontSize: "12pt",
    showLineNumbers: true,
    showGutter: true,
    vScrollBarAlwaysVisible:true,
    enableBasicAutocompletion: true, enableLiveAutocompletion: true
  });

  editor.setShowPrintMargin(true);
  editor.setBehavioursEnabled(true);
	}

	function ready()
	{
		html();
		update();
	}
</script>

</body>
</html>

<?php
include('css/Login-Style.php');
?>

<?php
include("js/Help-coder-gui.php");
?>